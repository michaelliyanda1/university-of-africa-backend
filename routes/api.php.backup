<?php

use App\Http\Controllers\AnalyticsController;
use App\Http\Controllers\AuthController;
use App\Http\Controllers\CmsController;
use App\Http\Controllers\DepartmentController;
use App\Http\Controllers\FeatureController;
use App\Http\Controllers\NewsController;
use App\Http\Controllers\PartnerController;
use App\Http\Controllers\ProgrammeController;
use App\Http\Controllers\PromotionalAdController;
use App\Http\Controllers\ResearchItemController;
use App\Http\Controllers\TestimonialController;
use App\Http\Controllers\VideoController;
use Illuminate\Support\Facades\Route;

Route::get('/test', function() {
    return response()->json(['status' => 'API is working']);
});

Route::post('/register', [AuthController::class, 'register']);
Route::post('/login', [AuthController::class, 'login']);

Route::get('/departments', [DepartmentController::class, 'index']);
Route::get('/departments/{department}', [DepartmentController::class, 'show']);

Route::get('/research', [ResearchItemController::class, 'index']);
Route::get('/research/{researchItem}', [ResearchItemController::class, 'show']);
Route::get('/research/{researchItem}/download', [ResearchItemController::class, 'download']);

Route::get('/cms/pages/{slug}', [CmsController::class, 'getPage']);
Route::get('/cms/sections/{page?}', [CmsController::class, 'getSections']);

Route::get('/news', [NewsController::class, 'index']);
Route::get('/news/latest', [NewsController::class, 'latest']);
Route::get('/news/{news}', [NewsController::class, 'show']);

Route::get('/testimonials', [TestimonialController::class, 'index']);
Route::get('/testimonials/featured', [TestimonialController::class, 'featured']);

Route::get('/programmes', [ProgrammeController::class, 'index']);
Route::get('/programmes/featured', [ProgrammeController::class, 'featured']);
Route::get('/programmes/{programme}', [ProgrammeController::class, 'show']);

Route::get('/promotional-ads', [PromotionalAdController::class, 'index']);
Route::get('/features', [FeatureController::class, 'index']);
Route::get('/videos', [VideoController::class, 'index']);
Route::get('/partners', [PartnerController::class, 'index']);

Route::middleware('auth:sanctum')->group(function () {
    Route::post('/logout', [AuthController::class, 'logout']);
    Route::get('/me', [AuthController::class, 'me']);
    
    Route::post('/research', [ResearchItemController::class, 'store']);
    Route::post('/research/{researchItem}/approve', [ResearchItemController::class, 'approve']);
    Route::post('/research/{researchItem}/reject', [ResearchItemController::class, 'reject']);
    
    Route::get('/analytics/dashboard', [AnalyticsController::class, 'dashboard']);
    
    Route::post('/cms/pages', [CmsController::class, 'storePage']);
    Route::put('/cms/sections/{section}', [CmsController::class, 'updateSection']);
});
